.. _architecture:

##########################
系统架构设计 (v5.3 - 数据一致性修复)
##########################

(Omitted for brevity...)

关键设计决策
====================

(Omitted for brevity...)

10. **文件操作与数据库的原子性 (v5.3)**: 这是一个关键的数据一致性原则。任何改变文件物理路径的操作（如移动、重命名）**必须**被视为一个原子事务。执行物理文件操作的代码，**必须**在操作成功后，立即、无条件地更新数据库中对应记录的 `file_path` 字段，以反映其新的、权威的路径。这从根本上保证了数据库状态与文件系统状态的实时同步，杜绝了“文件已移动但数据库未更新”而导致的“文件未找到”错误。

附录：数据库初始化与操作最佳实践 (v5.2)
==================================================

(Omitted for brevity...)
