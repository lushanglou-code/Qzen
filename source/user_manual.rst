.. _user_manual:

##########################
Qzen (千针) v5.4 用户手册
##########################

欢迎使用 Qzen (千针)，一个专为 Windows 用户设计的本地文档智能整理客户端。本工具旨在帮助您高效地管理数以千计的本地文档，核心功能是清理重复文件、对内容相似的文件进行自动聚类整理，以及查找相似文件。

---

推荐工作流程
======================

为了获得最佳体验，我们推荐您按照UI界面上标签页的顺序，从左到右依次完成操作：

**1. 配置 -> 2. 数据摄取 -> 3. 迭代式聚类 -> 4. 关键词搜索 -> 5. 相似文件分析**

下面将对每个步骤进行详细说明。

阶段一：配置
------------------

在开始任何操作之前，您需要先完成所有配置。此步骤在主界面的 **“1. 配置”** 标签页中完成。

1.  **数据库配置**: 
    *   点击 **“配置数据库”** 按钮。
    *   在弹出的对话框中，输入您的 **MySQL 数据库** 的连接信息（地址、端口、用户名、密码）。该配置会自动保存到 `config.json` 文件中。
    *   点击“确定”后，程序会自动测试连接。只有连接成功，后续步骤才能继续。

2.  **路径配置**:
    *   **源文件夹**: 指定您存放着大量原始、杂乱文档的根目录。
    *   **中间文件夹**: 指定一个**空目录**。程序在去重后，会将所有唯一的文档副本复制到这里。后续的所有分析和整理都将基于这个文件夹内的文件进行。
    *   **目标文件夹**: 指定一个**空目录**。所有导出的结果（例如关键词搜索结果、相似文件分析结果）都将存放在这里。

3.  **自定义停用词**:
    *   在文本框中，您可以输入一些您特有的、希望在分析中被忽略的词语（例如您的公司名、产品名等），每行一个。
    *   修改后，点击 **“保存停用词”** 按钮，您的设置将立即对后续的所有分析任务生效。

> **注意**: 程序在关闭时会自动保存您选择的三个文件夹路径和停用词列表，方便下次使用。

阶段二：数据摄取
----------------------

当配置完成后，切换到 **“2. 数据摄取”** 标签页。

1.  点击 **“开始摄取”** 按钮。程序会弹出一个确认框，因为此操作会清空数据库和中间文件夹。
2.  确认后，程序将自动开始执行一个两阶段的后台任务：
    *   **第一阶段：去重与复制**。扫描您的“源文件夹”，找出所有内容唯一的文档，并将它们复制到“中间文件夹”。
    *   **第二阶段：文本预处理与向量化**。处理“中间文件夹”中的所有文档，提取内容摘要，并使用 TF-IDF 算法将其转化为可供计算机比较的“特征向量”，存入数据库。

> **提示**: 此步骤可能需要一些时间，具体取决于您的文档数量。您可以通过主窗口底部的进度条查看实时进度。完成后，程序会提示“数据摄取流程成功完成！”

阶段三：迭代式聚类工具
--------------------------

这是 Qzen 的核心整理功能。切换到 **“3. 分析与聚类”** 标签页，您可以使用两种独立的工具对文档进行逐步细化的整理。

您可以对“中间文件夹”内的任意目录（或子目录）重复运行这些工具，实现迭代式整理。

**工具一：K-Means 聚类 (宏观分类)**

此工具用于将大量主题分散的文档进行快速、初步的宏观分类。

1.  点击 **“选择文件夹...”** 按钮，选择一个您希望整理的文件夹。
2.  **设置 K值**: 在“K-Means K值”输入框中，指定您希望将这些文件大致分成几个类别。
3.  点击 **“运行 K-Means 聚类”** 按钮。
4.  程序将在后台执行操作。完成后，您会看到所选文件夹内的文件被移动到了以数字编号（`0/`, `1/`, ...）命名的子文件夹中。

**工具二：相似度聚类 (微观分组)**

此工具用于从一批文档中精确地找出内容高度相似的小群体，适合进行细粒度的归档。

1.  点击 **“选择文件夹...”** 按钮，选择一个您希望整理的文件夹。
2.  **设置相似度阈值**: 在“相似度阈值”输入框中，设置一个判断文件是否相似的标准（推荐值为 `0.85`）。
3.  点击 **“运行相似度聚类”** 按钮。
4.  程序将在后台执行操作。完成后，文件夹内的文件会被重新组织：
    *   所有被识别出的**相似文件组**，会分别被移动到以其核心主题词命名的子文件夹中。
    *   所有**不属于任何相似文件组**的独立文件，则会被统一移动到一个名为 `alone` 的新子文件夹中。

阶段四：关键词搜索
----------------------

切换到 **“4. 关键词搜索”** 标签页。

1.  在输入框中输入您想查找的 **关键词**。
2.  选择搜索模式：**按文件名搜索** 或 **按文件内容搜索**。
3.  点击对应按钮后，所有匹配的结果会显示在下方的表格中。
4.  **选择与导出**: 
    *   您可以使用**复选框**和“**全选/全不选**”功能来选择您希望导出的文件。
    *   点击 **“导出选中结果到目标文件夹”** 按钮，所有选中的文件将被复制到“目标文件夹”下的一个以关键词命名的新目录中。

阶段五：相似文件分析
----------------------

此功能允许您针对某一个文件，找出它所有的“近亲”。此功能位于 **“3. 分析与聚类”** 标签页的第二个功能区。

1.  点击 **“选择文件...”** 按钮，在弹出的对话框中选择一个您感兴趣的“源文件”。
2.  **设置 Top N**: 您希望找出最相似的前多少个文件。
3.  点击 **“查找相似文件”** 按钮。
4.  稍等片刻，下方的结果表格中就会显示出与您选中的文件内容最相似的文件列表，以及它们各自的“相似度分数”。
5.  **选择与导出**: 
    *   您可以使用每一行前面的**复选框**来勾选您希望导出的文件。
    *   也可以使用表格上方的“**全选/全不选**”来快速操作。
    *   完成选择后，点击 **“导出选中项”** 按钮。
    *   所有选中的文件将被复制到“目标文件夹”下的一个新子目录中。该目录会自动以您的源文件名来命名（例如 `MyReport_相似文件/`），方便您查找。

---

## 开发者信息

*   **开发者**: Luzhao
*   **联系方式**: 597805263@qq.com

如果您在使用过程中遇到任何问题或有改进建议，欢迎随时联系！
