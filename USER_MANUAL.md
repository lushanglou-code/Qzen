# Qzen (千针) - 用户使用说明

欢迎使用 Qzen (千针)，一个专为 Windows 用户设计的本地文档智能整理客户端。本工具旨在帮助您高效地管理数以千计的本地文档，核心功能是清理重复文件和对内容相似的文件进行自动聚类整理。

---

## 推荐工作流程

为了获得最佳体验，我们推荐您按照UI界面上标签页的顺序，从左到右依次完成操作：

**1. 配置 -> 2. 批量处理 -> 3. 交互式分析 (可选) -> 4. 自动整理 -> 5. 关键词搜索**

下面将对每个步骤进行详细说明。

### 步骤一：配置

在开始任何操作之前，您需要先完成所有配置。此步骤在主界面的 **“1. 配置”** 标签页中完成。

1.  **数据库配置**: 
    *   点击 **“第一步：配置数据库”** 按钮。
    *   在弹出的对话框中，输入您的 **DM8 (达梦) 数据库** 的连接信息（地址、端口、用户名、密码）。
    *   点击“确定”后，程序会自动测试连接。只有连接成功，后续步骤才能继续。

2.  **路径配置**:
    *   **源文件夹**: 指定您存放着大量原始、杂乱文档的根目录。
    *   **中间文件夹**: 指定一个**空目录**。程序在去重后，会将所有唯一的文档副本复制到这里。后续的所有分析和整理都将基于这个文件夹内的文件进行。
    *   **目标文件夹**: 指定一个**空目录**。所有最终的整理结果（例如自动创建的文件簇）都将存放在这里。

> **注意**: 程序在关闭时会自动保存您选择的这三个文件夹路径，方便下次使用。

### 步骤二：批量处理

当配置完成后，切换到 **“2. 批量处理”** 标签页。这里有两个核心的后台处理任务。

1.  **执行去重**: 
    *   点击此按钮，程序会开始扫描您的“源文件夹”。
    *   它会精确地计算每个文件的内容哈希值，找出所有内容完全相同的重复文件。
    *   最终，它会将每个不重复的、唯一的文档复制一份到您指定的“中间文件夹”中。

2.  **执行向量化**:
    *   在去重完成后，点击此按钮。
    *   程序会开始处理“中间文件夹”中的所有文档，提取每个文档的“内容摘要”（开头和结尾的文本）。
    *   然后，它使用智能的 **TF-IDF 算法** 将这些文本摘要转化为可供计算机理解和比较的“特征向量”，并将这些计算结果存入数据库，以备后续分析使用。

> **提示**: 这两个步骤可能需要一些时间，具体取决于您的文档数量。您可以通过主窗口底部的进度条查看实时进度。

### 步骤三：交互式分析 (可选)

如果您想在自动整理前，先手动探索一下哪些文件是相似的，可以切换到 **“3. 交互式分析”** 标签页。

1.  点击 **“加载文件列表并预热引擎”** 按钮。程序会加载“中间文件夹”中的所有文档，并准备好相似度计算引擎。
2.  在左侧的文件列表中，**单击选中**一个您感兴趣的文件。
3.  点击 **“查找相似文件”** 按钮。
4.  稍等片刻，右侧的表格中就会显示出与您选中的文件内容最相似的前10个文件及其相似度得分（得分越接近1.0表示越相似）。

### 步骤四：自动整理

这是 Qzen 最核心的功能。当您完成了“批量处理”后，可以切换到 **“4. 自动整理”** 标签页，让程序为您自动整理所有相似的文件。

1.  **设置相似度阈值**: 
    *   这是一个介于 0.0 到 1.0 之间的数值，用于判断文件是否“足够相似”从而可以被归为一类。
    *   **推荐值**: `0.85`。这个值在大多数情况下能在“确保真正相似”和“避免漏掉”之间取得良好平衡。
    *   如果您希望分类更严格（只有内容高度一致的才算一类），可以适当调高此值（如 `0.9`）。如果您希望更宽泛地查找相关主题，可以适当调低此值（如 `0.8`）。

2.  **点击“开始自动整理”按钮**: 
    *   程序会弹出一个确认框，因为这是一个文件操作。
    *   确认后，程序会开始分析所有文档的相似度。当发现一组文件的相似度均高于您设定的阈值时，它会执行以下操作：
        *   在“目标文件夹”下，根据这组文件的**核心主题词**，自动创建一个新的子目录（例如 `“数据库_性能_优化”`）。
        *   将这组相似的文件**原封不动地复制**到这个新目录中。**程序不会重命名您的文件**。
    *   **处理未归类文件**: 如果有些文件没有找到任何可以归类的相似伙伴，它们会被统一复制到“目标文件夹”下的一个名为 `“未归类”` 的特殊文件夹中。这方便您进行二次整理。

执行完毕后，您就可以在“目标文件夹”中看到所有相似文件已经被分门别类地整理在不同的主题子目录中了。

### 功能五：关键词搜索

除了基于内容相似度的智能聚类，Qzen 还提供了简单的基于关键词的搜索功能。切换到 **“5. 关键词搜索”** 标签页。

1.  在输入框中输入您想查找的 **关键词**。
2.  选择搜索模式：
    *   **按文件名搜索**: 在“中间文件夹”中查找所有 **文件名** 包含该关键词的文档。
    *   **按文件内容搜索**: 在所有文档的 **内容摘要** (数据库中缓存的文本切片) 中查找包含该关键词的文档。
3.  点击对应按钮后，所有匹配的文件将被复制到“目标文件夹”下的一个新目录中（例如 `“目标文件夹\内容包含_关键词”` 或 `“目标文件夹\文件名包含_关键词”`）。

---

## 开发者信息

*   **开发者**: Luzhao
*   **联系方式**: 597805263@qq.com

如果您在使用过程中遇到任何问题或有改进建议，欢迎随时联系！
